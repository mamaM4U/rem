⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿
⣿⣿⣿⣿⣻⣿⣟⣿⣿⣻⣿⣻⣿⣟⣿⣿⡿⣿⣽⢿⣽⡻⠻⠛⠻⠻⣛⣿⣽⢯⣿⣿⡿⣿⣿⢿⣟⣿⣿⣻⣿⣻⣿⣟⣿⣿⣻⣿⣻⣿
⣿⣿⣿⣾⣿⣿⡿⣿⡿⣿⣿⢿⣿⡿⣿⠟⢛⢙⡽⣾⢻⣺⣳⣳⢽⢯⣟⢾⢽⣺⡻⣻⢿⣿⣿⣿⣿⣿⣿⢿⣿⢿⣿⡿⣿⡿⣿⣿⢿⣿
⣿⣿⣯⣿⣿⣷⣿⣿⣿⣿⣯⡾⣯⣿⣋⢬⢮⢯⣻⣺⢽⣺⣺⣺⣹⡳⡯⣯⡻⡮⡗⣦⢄⣝⣷⣧⣻⣷⣿⣿⣿⣿⣿⡿⣿⣿⣿⣿⢿⣿
⣿⣿⣿⣽⣷⣿⣿⣯⣿⣯⣿⡻⢹⣺⢝⡽⣝⣗⡗⣽⢽⣺⣺⡺⣮⡫⣟⢮⡏⡇⡟⡞⡽⡮⣳⣫⣹⡭⣿⣿⣽⣿⣷⣿⣿⣿⣷⣿⣿⣿
⣿⣿⣟⣿⣿⣻⣷⣿⣿⡿⡁⣢⣳⢽⣝⣎⣗⢷⢽⣺⣳⣳⣳⡻⣺⣪⣺⡪⡬⣖⢮⣞⣞⡽⡵⡢⢯⢇⣿⠿⣻⣟⣿⣿⣻⣽⣾⣿⣿⣻
⣿⣿⣿⡿⣟⣿⣿⢽⣯⡷⢮⡳⣕⢯⢞⣞⢮⣻⢸⣺⡪⣞⢮⣞⢵⡳⣳⣭⢯⣺⣚⢮⢺⣺⢭⢝⢜⢖⣫⣿⢼⣿⣿⢿⣿⣿⣿⣿⣽⣿
⣿⣿⣽⣿⣿⣿⣿⣿⣾⢝⣗⢽⢵⡹⡵⣳⢽⣪⢳⣳⣝⣗⢽⡪⣗⣹⢺⣝⣺⣺⡪⣏⢗⡽⡕⡽⡑⡡⣩⣛⣺⣿⣿⣿⡿⣿⣾⣿⡿⣿
⣿⣿⣿⢿⣻⣿⣷⣿⣏⢗⣗⢽⣕⢯⢯⡺⡵⣳⣱⣳⡳⣕⢯⣫⢞⡼⣺⣯⢿⣳⣟⣎⡪⣯⡺⣔⢭⢎⡚⣧⣻⣿⣿⣾⣿⣿⣿⣯⣿⣿
⣿⣿⣿⣿⣿⣿⣯⣿⡷⣝⢮⣳⢳⣹⡪⡯⣫⢞⡮⡺⡮⡯⣳⢽⣕⣟⠮⢛⠈⣍⢜⢽⣺⢺⡊⢔⢳⢕⢇⢧⣿⣿⣿⣽⣿⣿⣽⣿⣿⣿
⣿⣿⣿⣾⣿⣷⣿⣿⣗⢽⢕⢗⡽⣚⢮⣳⢝⡷⡭⣏⢯⢯⣳⢯⣞⢮⢳⡇⡂⢦⢸⡺⡮⡧⣷⡻⡵⣕⠧⡝⣿⣷⣿⡿⣿⣾⣿⡿⣷⣿
⣿⣿⣿⣾⣿⣯⣿⣿⣿⡹⣝⡕⣯⡳⡽⣺⣕⢯⣟⣞⡽⣽⣺⢽⡺⡎⣿⣳⣽⡮⣞⢷⣫⢽⢮⡺⡯⣺⣕⡯⣿⣿⣽⣿⣿⣿⣻⣿⣿⣿
⣿⣿⣯⣿⣯⣿⣿⣷⣿⡟⣮⡺⣕⣟⢾⢵⣫⣗⢷⣳⢽⣺⢾⣽⢽⣽⢿⣽⢾⣻⡽⡯⣾⣹⡵⡞⡹⣪⢣⡗⣿⣿⣿⣻⣯⣿⣿⡿⣯⣿
⣿⣿⣟⣿⣟⣿⣷⣿⣿⣷⡵⢝⡮⡮⡻⣮⣳⢯⣟⣾⣻⣽⣟⣾⣻⢾⣻⣾⣻⡽⣯⣟⡷⠏⢏⢂⣪⣿⢲⣏⣿⣯⣿⣿⡿⣿⣟⣿⣿⣿
⣿⣿⣿⢿⣿⣟⣿⣯⣷⣿⣿⣗⢵⠹⢕⡗⣯⡿⣞⣯⢿⣺⣷⣻⡽⣿⢽⣞⣷⣟⣿⡺⠣⢡⣍⣴⣿⡧⣽⡧⣿⣿⣻⣿⡿⣿⣿⢿⣿⣻
⣿⣿⣾⣿⣿⡿⣿⡿⣿⣿⣻⣿⣿⣕⣅⠪⠨⠻⢽⡯⣿⡽⣾⣳⡿⣽⡯⣿⣺⢗⠫⢨⣬⡾⣿⣿⣿⢬⣿⢰⣿⣿⢿⣿⡿⣿⣿⢿⣿⣿
⣿⣿⣿⣻⣿⢿⣿⣿⣿⡿⣿⣿⣾⣿⣿⣮⣼⣬⣦⣊⣝⡝⡻⣺⢻⣗⢿⢫⢳⢸⢾⢿⣿⣿⣿⣷⡯⣼⣿⣹⣿⣽⣿⣿⡿⣿⣿⣿⣿⢿
⣿⣿⣻⣿⣿⣿⣿⣷⡿⡿⣟⣿⣾⣿⣷⣿⣿⣿⣿⣞⣯⢿⢜⣎⢧⢳⡱⡝⣼⢿⣽⣻⣿⣷⣿⣷⣶⣿⡿⡿⣟⡿⡿⣯⣿⣿⣿⣾⣿⣿
⣿⣿⣿⡿⣷⣿⡿⣷⣻⣟⡿⣞⣷⢝⡯⣿⣷⣿⣿⢞⣽⢿⣽⢾⣳⢕⣾⣻⣟⣿⣚⢿⣿⣾⣿⣯⠿⣻⣞⣯⣾⣻⣽⣿⣿⣿⣯⣿⣿⣽
⣿⣿⣷⣿⣿⣿⣿⣿⡽⣾⣻⣯⣟⣧⣿⣻⡽⣯⣟⣯⣷⢿⣽⡻⡽⡯⡷⣿⣺⣷⣻⣽⢾⣳⢽⡾⣏⣿⡽⣷⣻⣽⢾⣟⣿⣾⣿⣟⣿⣿
⣿⣿⣟⣿⣿⣽⣿⣽⣿⢽⣾⣳⣯⡷⣞⣷⢟⣿⣺⣟⡾⠋⣠⡶⠀⡄⢬⣍⠓⢯⣷⣟⣿⣝⣯⢟⣽⢷⣟⣯⡿⣺⣿⣿⣿⡿⣟⣿⣿⣻
⣿⣿⣿⣻⣿⣻⣿⣟⣿⣿⣺⣽⣾⣻⣾⣽⣶⣟⣷⣻⣀⣾⣛⣀⣺⣇⣀⣻⣽⣦⣱⣿⣞⣞⣾⣻⣽⣯⣻⣪⣾⣿⣿⣿⣽⣿⣿⣿⣿⣿
⣿⣿⣟⣿⣿⢿⣿⣟⣿⣿⢿⣿⢿⣿⣟⣿⣟⣿⣿⢿⣿⣿⣿⣿⣿⣿⢿⣿⣿⣿⢿⣻⣿⢿⣿⢿⣿⣟⣿⣿⣿⣿⣽⣾⣿⣿⣿⣽⣾⣿


# Rem Workspace

A monorepo forged with Melos, created to unite and orchestrate its two code-born twins: Arona (Flutter) and Plana (Dart Frog). Under Rem’s structure, both modules work in sync toward a single purpose. Represented to the world with elegance and grace by Arisu (Jaspr).

[![melos](https://img.shields.io/badge/maintained%20with-melos-f700ff.svg?style=flat-square)](https://github.com/invertase/melos) 
[![flutter](https://img.shields.io/badge/flutter-%2361DAFB.svg?style=flat-square&logo=flutter&logoColor=white)](https://flutter.dev)
[![dart](https://img.shields.io/badge/dart-%232275C7.svg?style=flat-square&logo=dart&logoColor=white)](https://dart.dev)
[![jaspr](https://img.shields.io/badge/jaspr-%23EC4899.svg?style=flat-square&logo=dart&logoColor=white)](https://jaspr.site)
[![Free Palestine](https://img.shields.io/badge/free%20palestine-%23E91E63.svg?style=flat-square&logo=github-sponsors&logoColor=white)](https://palestine-liberation.org)

## Project Structure

```
rem/
├── app/              # Flutter application (arona)
├── api_server/       # Dart Frog API server (plana)
├── landing_page_ssr/ # Jaspr landing page (arisu)
├── packages/
│   └── shared/       # Shared code between app and server
└── pubspec.yaml      # Workspace configuration
```

## Requirements

- Dart SDK: ^3.5.0
- Flutter SDK
- Melos: ^7.3.0
- PostgreSQL (for database)

## Setup

1. Install Melos globally:
```bash
dart pub global activate melos
```

2. Bootstrap workspace:
```bash
melos bootstrap
```

3. Setup environment variables:
```bash
# In app/
cp .envied.example .envied
# Edit .envied with your configuration
# Important: If using Android physical device, update API_BASE_URL_PHYSICAL with your LAN IP
# Find your LAN IP: Windows (ipconfig), Mac (ifconfig), Linux (ip addr show)

# In api_server/
cp .env.example .env
# Edit .env with your configuration

# In landing_page_ssr/ (optional)
cp .envied.example .envied
# Edit .envied with your configuration
```

## Development

### Quick Start

1. Start Plana with database:
```bash
melos plana:docker:up
```

1. Run Plana only:
```bash
melos plana
```

1. Run Flutter app (in separate terminal):
```bash
melos arona
```

## Melos Commands

### Application
- `melos arona` - Run Flutter app (arona)
- `melos plana` - Run Dart Frog server (plana)
- `melos arisu` - Run Jaspr landing page (arisu)
- `melos arisu:build` - Build Jaspr landing page for production

### Docker (Plana Only)
- `melos plana:docker:up` - Start Plana + Database
- `melos plana:docker:down` - Stop Plana containers
- `melos plana:docker:logs` - View Plana logs
- `melos plana:docker:restart` - Restart Plana containers

### Docker (Full Stack)
- `melos docker:up` - Start all services (DB + Plana + Arisu)
- `melos docker:down` - Stop all services
- `melos docker:logs` - View all container logs
- `melos docker:build` - Build all container images
- `melos docker:restart` - Restart all services

### Dependencies
- `melos bootstrap` - Initialize workspace and get all dependencies
- `melos get` - Get dependencies for all packages

### Code Quality
- `melos analyze` - Run dart analyze in all packages
- `melos format` - Format all Dart files
- `melos test` - Run tests in all packages

### Build & Generation
- `melos build:runner` - Run build_runner for code generation (envied, json_serializable)
- `melos clean` - Clean all Flutter packages

### Typical Development Workflow

**Option 1: Local Development (Multiple Terminals)**
```bash
# Initial setup
melos bootstrap

# Start development
melos plana:docker:up      # Start database
melos plana                # Start API server (terminal 1)
melos arona                # Start Flutter app (terminal 2)
melos arisu                # Start landing page (terminal 3)

# View logs
melos plana:docker:logs    # View database logs

# Cleanup
melos plana:docker:down    # Stop database
```

**Option 2: Full Docker Stack**
```bash
# Build and start all services
melos docker:up

# Services available at:
# - Arisu (Landing): http://localhost:3000
# - Plana (API):     http://localhost:8080
# - PostgreSQL:      localhost:5432

# View logs
melos docker:logs

# Stop all
melos docker:down
```

## Tech Stack

### App (arona)

**State Management & Navigation:**
- GetX - Lightweight state management & routing

**Network & API:**
- Dio - HTTP client with interceptors

**Storage & Security:**
- flutter_secure_storage - Encrypted storage (Keychain/EncryptedSharedPreferences)
- local_auth - Biometric authentication

**UI Components:**
- Skeletonizer & Shimmer - Loading states
- Cached Network Image - Image caching
- EasyLoading - Loading indicators
- Flutter SVG - SVG support

**Utilities:**
- intl & jiffy - Date/time formatting & localization
- envied - Type-safe environment variables
- json_annotation & json_serializable - JSON serialization

### API Server (plana)

**Framework:**
- Dart Frog - Fast & minimalist API framework

**Authentication & Security:**
- bcrypt - Password hashing
- dart_jsonwebtoken - JWT authentication
- uuid - Unique ID generation

**Database:**
- postgres - PostgreSQL client

**Validation & Utilities:**
- validators2 - Email, URL, phone validation
- decimal - Precise decimal arithmetic (for money/currency)
- intl - Internationalization & formatting
- logging - Structured logging

**HTTP & Integration:**
- dio - HTTP client for external API calls

**Config & Environment:**
- envied - Type-safe environment variables

**Serialization:**
- json_annotation & json_serializable - JSON serialization

### Landing Page (arisu)

**Framework:**
- Jaspr - Dart web framework with SSR

**Routing:**
- jaspr_router - Client-side routing

**Styling:**
- CSS-in-Dart - Type-safe styling system

**Development:**
- jaspr_builder - Build system
- jaspr_web_compilers - Web compilation
- jaspr_lints - Linting rules

### Shared Package

Contains shared code between app and server:
- Constants
- Models/DTOs
- Utilities

## Best Practices

### Secure Storage
```dart
import 'package:arona/helpers/secure_storage.dart';

// Write
await secureStorage.write('auth_token', token);

// Read
final token = await secureStorage.read('auth_token');

// Clear all
await secureStorage.clearAll();
```

### Environment Variables
```dart
// Use envied for type-safe env vars
@Envied(path: '.env')
abstract class Env {
  @EnviedField(varName: 'API_URL', obfuscate: true)
  static String apiUrl = _Env.apiUrl;
}
```

### Money Handling
```dart
import 'package:decimal/decimal.dart';

// Always use Decimal for money
Decimal price = Decimal.parse('99.99');
Decimal total = price * Decimal.fromInt(quantity);
```

### Validation
```dart
import 'package:validators2/validators2.dart';

if (!isEmail(email)) {
  throw Exception('Invalid email');
}
```

## Troubleshooting

### Android Physical Device Not Connecting to API

If you're running the app on an Android physical device and can't connect to the API server:

1. **Find your computer's LAN IP address**:
   ```bash
   # Windows
   ipconfig
   # Look for "IPv4 Address" (e.g., 192.168.1.100)

   # Mac
   ifconfig | grep 'inet ' | grep -v 127.0.0.1

   # Linux
   ip addr show | grep 'inet ' | grep -v 127.0.0.1
   ```

2. **Update your app's `.envied` file**:
   ```bash
   # In app/.envied
   API_BASE_URL_PHYSICAL=http://YOUR_LAN_IP:8080
   # Example: API_BASE_URL_PHYSICAL=http://192.168.1.100:8080
   ```

3. **Regenerate environment files**:
   ```bash
   melos build:runner
   ```

4. **Ensure your device and computer are on the same network** (WiFi)

5. **Make sure the API server is running** and accessible from your network

**Note**: The app automatically detects whether you're using:
- Android Emulator (uses `10.0.2.2`)
- Android Physical Device (uses your LAN IP)
- iOS Simulator (uses `localhost`)
- Web/Desktop (uses `localhost`)

## Git Workflow

```bash
# Create feature branch
git checkout -b feature/feature-name

# Commit changes
git add .
git commit -m "feat: feature description"

# Push & create PR
git push origin feature/feature-name
```

## License

MIT License
